<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EMS System - Activity Diagram</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@9.4.3/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: white;
            padding: 20px;
            line-height: 1.6;
        }
        .container { 
            max-width: 800px; 
            margin: 0 auto; 
        }
        .header { 
            text-align: center; 
            margin-bottom: 40px; 
            padding: 20px; 
            border-bottom: 3px solid #2d4891; 
        }
        .header h1 { 
            color: #2d4891; 
            font-size: 2rem; 
            margin-bottom: 10px; 
        }
        .header p { 
            color: #666; 
            font-size: 1.1rem; 
        }
        .diagram-content { 
            padding: 15px; 
            background: white; 
            border: 1px solid #ddd; 
            border-radius: 5px; 
            margin: 15px 0; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .mermaid { 
            text-align: center; 
            transform: scale(0.8);
            transform-origin: center top;
        }
        .export-buttons { 
            text-align: center; 
            margin: 40px 0; 
            padding: 20px; 
            background: #f8f9fa; 
            border-radius: 5px; 
        }
        .export-btn { 
            background: #2d4891; 
            color: white; 
            border: none; 
            padding: 12px 24px; 
            border-radius: 5px; 
            font-size: 1rem; 
            cursor: pointer; 
            margin: 0 10px; 
        }
        .export-btn:hover { 
            background: #1e3a8a; 
        }
        .export-btn.secondary { 
            background: #059669; 
        }
        .export-btn.secondary:hover { 
            background: #047857; 
        }
        .description {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
            border-left: 4px solid #2d4891;
        }
        .description h3 {
            color: #2d4891;
            margin-bottom: 15px;
        }
        .description ul {
            margin-left: 20px;
        }
        .description li {
            margin-bottom: 8px;
            color: #555;
        }
        @media print { 
            .export-buttons { display: none; } 
            body { padding: 0; } 
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîÑ EMS System Activity Diagram</h1>
            <p>Environmental Management System - Chatbot & Enquiry Processing Flow</p>
        </div>

        <div class="description">
            <h3>üìã Activity Diagram Overview:</h3>
            <ul>
                <li><strong>Visitor Registration:</strong> Complete visitor onboarding process with data validation</li>
                <li><strong>Chatbot Interaction:</strong> AI-powered conversation flow with multiple service options</li>
                <li><strong>Enquiry Creation:</strong> Automatic lead generation and executive assignment</li>
                <li><strong>Content Search:</strong> FAQ and article search functionality with filtering</li>
                <li><strong>Executive Processing:</strong> Enquiry handling, response, and resolution workflow</li>
                <li><strong>Escalation System:</strong> Admin review for complex cases requiring attention</li>
            </ul>
        </div>

        <div class="export-buttons">
            <button class="export-btn" onclick="window.print()">üñ®Ô∏è Print/Export to PDF</button>
            <button class="export-btn secondary" onclick="reloadDiagram()">üîÑ Reload Diagram</button>
        </div>

        <div class="diagram-content">
            <div class="mermaid" id="activityDiagram">
                graph TD
                    Start([Visitor Arrives]) --> A{Has Account?}
                    A -->|No| B[Show Registration Form]
                    A -->|Yes| C[Login Process]
                    
                    B --> D[Collect Visitor Info]
                    D --> E[Validate Data]
                    E -->|Invalid| F[Show Error Message]
                    F --> B
                    E -->|Valid| G[Create Visitor Record]
                    
                    C --> H[Authenticate User]
                    H -->|Success| I[Load User Profile]
                    H -->|Failed| J[Show Login Error]
                    J --> C
                    
                    G --> K[Initialize Chat Session]
                    I --> K
                    
                    K --> L[Display Chatbot Interface]
                    L --> M[Show Welcome Message]
                    M --> N[Present Service Options]
                    
                    N --> O{User Action}
                    O -->|Ask Question| P[Process Query]
                    O -->|Search FAQ| Q[FAQ Search Interface]
                    O -->|Read Articles| R[Article Browser]
                    O -->|Create Enquiry| S[Enquiry Form]
                    
                    P --> T[AI Response Generation]
                    T --> U[Display Response]
                    U --> V{Need Human Help?}
                    V -->|Yes| S
                    V -->|No| W[Continue Chat]
                    W --> O
                    
                    Q --> X[Search FAQ Database]
                    X --> Y[Display Results]
                    Y --> Z[User Selects FAQ]
                    Z --> AA[Show Detailed Answer]
                    AA --> O
                    
                    R --> BB[Browse Articles]
                    BB --> CC[Filter by Category]
                    CC --> DD[Display Articles]
                    DD --> EE[User Reads Article]
                    EE --> O
                    
                    S --> FF[Collect Enquiry Details]
                    FF --> GG[Validate Enquiry Data]
                    GG -->|Invalid| HH[Show Validation Error]
                    HH --> FF
                    GG -->|Valid| II[Create Enquiry Record]
                    
                    II --> JJ[Assign to Executive]
                    JJ --> KK[Send Notification]
                    KK --> LL[Update Dashboard]
                    LL --> MM[Enquiry Processing]
                    
                    MM --> NN{Executive Action}
                    NN -->|Respond| OO[Send Response]
                    NN -->|Close| PP[Mark as Resolved]
                    NN -->|Escalate| QQ[Assign to Admin]
                    
                    OO --> RR[Update Chat History]
                    PP --> SS[Archive Enquiry]
                    QQ --> TT[Admin Review]
                    
                    RR --> O
                    SS --> End([Process Complete])
                    TT --> UU[Admin Decision]
                    UU --> End
            </div>
        </div>

        <div class="export-buttons">
            <button class="export-btn" onclick="window.print()">üñ®Ô∏è Print/Export to PDF</button>
            <button class="export-btn secondary" onclick="reloadDiagram()">üîÑ Reload Diagram</button>
        </div>
    </div>

    <script>
        // Initialize Mermaid with basic settings
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis',
                nodeSpacing: 30,
                rankSpacing: 30
            }
        });

        // Function to reload diagram
        function reloadDiagram() {
            location.reload();
        }
    </script>
</body>
</html>
